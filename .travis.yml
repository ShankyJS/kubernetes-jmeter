language: generic

dist: trusty
sudo: false

env:
  global:
    - HELM_VERSION="v2.11.0"

install:
  - wget http://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz -O /tmp/helm.tar.gz
  - tar xzf /tmp/helm.tar.gz -C /tmp --strip-components=1
  - chmod +x /tmp/helm

before_deploy:
  - /tmp/helm init --client-only
  - /tmp/helm repo add stable https://kubernetes-charts.storage.googleapis.com

deploy:
  provider: script
  skip_cleanup: true
  script: .travis/build.sh
  on:
    branch: master
branches:
  only:
    - master
